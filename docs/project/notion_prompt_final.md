# 노션 정리용 프롬프트 (최종)

다음 대화 내용을 노션 페이지로 정리해주세요.

---

## 📋 작업 요청

아래 제공된 대화 내용을 바탕으로 **무역량 예측 AI 모델 개발 프로젝트**를 노션 문서로 정리해주세요. 
각 섹션은 명확하게 구분하고, 코드, 표, 다이어그램을 적절히 활용해주세요.

---

## 📚 필수 목차 구조

```
1. 프로젝트 개요
   - 목적: 무역 품목 간 공행성 쌍 판별 및 후행 품목 무역량 예측
   - 데이터: 2022년 1월 ~ 2025년 7월 무역 수입 데이터
   - 목표: 2025년 8월 무역량 예측

2. 초기 모델 (Baseline) 구현
   - 데이터 전처리
   - 공행성쌍 탐색
   - 회귀 모델 학습
   - 예측 결과

3. 데이터 전처리 상세 분석
   - 원본 데이터 구조
   - 전처리 3단계 (월별 집계 → 날짜 변환 → 피벗 테이블)
   - 각 단계의 목적과 이유

4. 핵심 개념 설명
   - 피벗 테이블 사용 이유
   - safe_corr 함수와 np.std
   - Lag 분석

5. 무역 도메인 검토 결과
   - 도메인 지식 미활용 발견
   - 문제점 6가지
   - 개선 필요성

6. HS4 코드 기계산업 공급망 분석
   - HS4 코드 분류 체계
   - 공급망 계층 구조 (Tier 1/2/3)
   - 연관성 통계 (85.8% 기계산업 관련)
   - 주요 발견사항

7. 공급망 기반 모델 개발
   - 개선 사항 4가지
   - 공급망 방향성 점수
   - 가중 상관계수
   - 모델 성과 (116% 증가)

8. 결과 비교 및 인사이트
   - Baseline vs Supply Chain 모델
   - 주요 발견사항
   - 향후 개선 방향
```

---

## 📝 대화 내용 핵심 요약

### Phase 1: 초기 모델 구현
**작업**: 무역량 예측 모델 코드 작성
- `train_model.py` 생성
- 데이터 전처리: `groupby(["item_id", "year", "month"])["value"].sum()`
- 피벗 테이블: `pivot(index="item_id", columns="ym", values="value")`
- 공행성쌍 탐색: lag 1~6, 상관계수 임계값 0.4
- 결과: 1,425개 공행성쌍 발견

**주요 질문과 답변**:
- Q: "데이터 전처리 어떻게 한건지 설명해봐"
  A: 3단계 - 월별 집계 → 날짜 통합 → 피벗 테이블
- Q: "year랑 month를 왜 묶는거야"
  A: 피벗 테이블 컬럼은 하나여야 함, 시간 순서 보장
- Q: "피벗 테이블은 왜 하는거여"
  A: 시계열 데이터 빠른 접근, 쉬운 슬라이싱
- Q: "np.std가 뭐냐"
  A: 표준편차, safe_corr에서 0인 경우 에러 방지

### Phase 2: 도메인 검토
**작업**: 무역 도메인 관점에서 코드 검토
**결과**: ❌ 도메인 지식 거의 미활용
**문제점**:
1. HS4 코드 미사용
2. 거래 유형(type) 미고려
3. 계절성 미고려
4. 공급망 관계 무시
5. 거시경제 요인 미고려
6. 무역량 단위/스케일 문제

### Phase 3: HS4 코드 분석
**작업**: train.csv의 HS4 코드가 기계산업 공급망과 관련 있는지 분석
**결과**: ✅ **85.8%가 기계산업 공급망 관련**

**통계**:
- 기계산업 관련 HS4: 39개 / 71개 (54.9%)
- 기계산업 관련 품목: 67개 / 100개 (67.0%)
- 기계산업 관련 무역량: 16.17조 / 18.85조 (85.8%)

**공급망 계층**:
- **Tier 1 (원자재)**: 화학제품 28-38장 (25개 코드)
  - 주요: 암모니아(2814), 비료(3102), 화학제품(3824), 니켈(2805)
- **Tier 2 (중간재)**: 금속제품 72-83장 (5개 코드)
  - 주요: 철강재(7207), 니켈(8102), 코발트(8105)
- **Tier 3 (최종제품)**: 기계류 84-85장 (6개 코드)
  - 주요: 전기모터(8501), 전자석(8505), 공작기계(8461)

**공급망 흐름**: 원자재(화학) → 중간재(금속) → 최종제품(기계)

### Phase 4: 공급망 기반 모델 개발
**작업**: 기계산업 공급망을 고려한 공행성 예측 모델 개발
**파일**: `train_model_supply_chain.py`

**주요 개선사항**:
1. **공급망 계층 구조 정의**: `get_supply_chain_tier(hs4)`
2. **공급망 방향성 점수**: `get_supply_chain_direction()`
   - 같은 HS4: 1.5점
   - 정상 방향 (원자재→최종제품): 2.0점
   - 같은 계층: 1.0점
   - 역방향: 0.5점
3. **가중 상관계수**: `weighted_corr = abs(corr) * supply_chain_score`
4. **추가 Feature**: `supply_chain_score`, `same_hs4`

**결과**:
- 공행성쌍: **1,425개 → 3,085개 (116% 증가)**
- 공급망 방향성 좋은 쌍: 원자재→최종제품 477개, 중간재→최종제품 92개
- Feature 중요도: `same_hs4` (136,626 (가장 높음)

---

## 🎨 노션 작성 스타일 가이드

### 1. 제목 구조
- H1: 프로젝트 제목
- H2: 주요 섹션 (Phase별)
- H3: 하위 섹션

### 2. 코드 블록
```python
# Python 코드는 코드 블록으로 표시
# 중요한 함수는 별도 코드 블록으로
```

### 3. 표 활용
- 통계 데이터: 표로 정리
- 비교 데이터: Baseline vs Supply Chain 모델 비교표
- 공급망 계층 분포: 계층별 통계표

### 4. 다이어그램
- 공급망 흐름도: 원자재 → 중간재 → 최종제품
- 데이터 전처리 파이프라인
- 모델 구조도

### 5. Callout/하이라이트
- ⚠️ 문제점: 노란색 Callout
- ✅ 발견사항: 초록색 Callout
- 💡 인사이트: 파란색 Callout
- 📊 통계: 회색 Callout

### 6. 토글
- 상세 코드 설명
- 함수 상세 설명
- 추가 분석 결과

---

## 📊 포함할 주요 통계 및 비교

### Baseline vs Supply Chain 모델
| 항목 | Baseline | Supply Chain | 개선 |
|------|----------|--------------|------|
| 공행성쌍 수 | 1,425개 | 3,085개 | +116% |
| Feature 수 | 5개 | 7개 | +2개 |
| 도메인 지식 | ❌ | ✅ | ✅ |
| 공급망 방향성 | ❌ | ✅ | ✅ |

### HS4 코드 분류 통계
| 계층 | HS4 범위 | 코드 수 | 주요 품목 |
|------|----------|---------|-----------|
| Tier 1 (원자재) | 28-38장 | 25개 | 암모니아, 비료, 화학제품 |
| Tier 2 (중간재) | 72-83장 | 5개 | 철강재, 니켈, 코발트 |
| Tier 3 (최종제품) | 84-85장 | 6개 | 전기모터, 전자석 |

### 공급망 계층 분포
- 원자재 → 최종제품: 477개 쌍
- 중간재 → 최종제품: 92개 쌍
- 같은 HS4 그룹: 69개 쌍

---

## 🔑 핵심 메시지

1. **도메인 지식의 중요성**
   - 단순 데이터 분석 → 도메인 지식 활용
   - 85.8%가 기계산업 공급망 관련 데이터
   - HS4 코드를 통한 공급망 구조 파악

2. **모델 성과**
   - 공행성쌍 116% 증가
   - 더 의미 있는 관계 발견
   - 공급망 방향성 반영

3. **실무 적용 가능성**
   - 실제 무역 데이터 분석에 적용 가능
   - 공급망 구조를 활용한 예측 모델
   - 해석 가능한 AI 모델

---

## 📎 참고 파일

작성 시 다음 파일들을 참고하세요:
- `train_model.py` (기존 모델)
- `train_model_supply_chain.py` (공급망 모델)
- `analyze_hs4.py` (HS4 분석)
- `hs4_analysis_report.md` (HS4 분석 보고서)
- `supply_chain_model_summary.md` (모델 요약)

---

## ✨ 최종 요청

위 내용을 바탕으로 **전문적이고 체계적인 노션 문서**를 작성해주세요. 
각 섹션은 독립적으로 읽을 수 있도록 구성하되, 전체적인 스토리텔링도 유지해주세요.
코드는 실행 가능하도록 정확히 복사하고, 통계는 표로 정리하며, 중요한 발견사항은 시각적으로 강조해주세요.

**특히 강조할 점**:
- 도메인 지식 활용의 중요성
- Baseline → Supply Chain 모델로의 진화 과정
- 구체적인 수치와 통계
- 실무 적용 가능성

