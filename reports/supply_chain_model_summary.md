# 기계산업 공급망 기반 공행성 예측 모델 요약

## 🎯 모델 개선 사항

### 기존 모델 vs 공급망 모델 비교

| 항목 | 기존 모델 | 공급망 모델 | 개선 |
|------|----------|------------|------|
| **공행성쌍 수** | 1,425개 | 3,085개 | **+1,660개 (116% 증가)** |
| **도메인 지식 활용** | ❌ 없음 | ✅ HS4 코드, 공급망 계층 | ✅ |
| **공급망 방향성** | ❌ 무시 | ✅ 원자재→중간재→최종제품 | ✅ |
| **Feature 수** | 5개 | 7개 | +2개 |

---

## 🔧 주요 개선 기능

### 1. 공급망 계층 구조 정의

```python
def get_supply_chain_tier(hs4):
    """HS4 코드를 기반으로 공급망 계층 반환"""
    - Tier 1: 원자재 (화학제품, 28-38장)
    - Tier 2: 중간재 (금속제품, 72-83장)
    - Tier 3: 최종제품 (기계류, 84-85장)
```

### 2. 공급망 방향성 점수

```python
def get_supply_chain_direction(leader_hs4, follower_hs4):
    """공급망 방향성 점수 계산"""
    - 같은 HS4 그룹: 1.5점
    - 정상 방향 (원자재 → 최종제품): 2.0점
    - 같은 계층: 1.0점
    - 역방향: 0.5점
```

### 3. 가중 상관계수

```python
# 공급망 방향이 좋으면 상관계수에 가중치 적용
weighted_corr = abs(best_corr) * supply_chain_score

# 공급망 방향이 좋으면 임계값을 낮춤
effective_threshold = corr_threshold / supply_chain_score
```

### 4. 추가 Feature

기존: `b_t`, `b_t_1`, `a_t_lag`, `max_corr`, `best_lag`

추가: `supply_chain_score`, `same_hs4`

---

## 📊 공급망 계층 분포

### 공행성쌍의 계층 분포

```
leader_tier  follower_tier  쌍 수
0 (기타)     0 (기타)       212
             1 (원자재)     940
             2 (중간재)     187
             3 (최종제품)   323

1 (원자재)   0 (기타)       7
             1 (원자재)     486
             2 (중간재)     276
             3 (최종제품)   477  ← 공급망 방향성 좋음!

2 (중간재)   0 (기타)       2
             1 (원자재)     2
             2 (중간재)     24
             3 (최종제품)   92   ← 공급망 방향성 좋음!

3 (최종제품) 0 (기타)       4
             1 (원자재)     6
             2 (중간재)     3
             3 (최종제품)   44
```

### 주요 발견사항

1. **원자재 → 최종제품**: 477개 쌍 (공급망 방향성 우수)
2. **중간재 → 최종제품**: 92개 쌍 (공급망 방향성 우수)
3. **같은 HS4 그룹**: 69개 쌍 (같은 품목 그룹 내 공행성)

---

## 🎯 Feature 중요도

```
b_t: 0.520206              ← 현재 무역량 (가장 중요)
b_t_1: 0.424088            ← 직전 달 무역량
same_hs4: 136626.651883    ← 같은 HS4 그룹 (매우 중요!)
supply_chain_score: 33309.245889  ← 공급망 점수
best_lag: 8778.468000      ← 최적 lag
a_t_lag: -0.002331         ← 선행 품목 lag 값
max_corr: -102581.853448   ← 상관계수
```

**분석:**
- `same_hs4`가 매우 높은 계수를 가짐 → 같은 HS4 그룹 내 공행성이 강함
- `supply_chain_score`도 양의 계수 → 공급망 방향성이 예측에 도움

---

## 📈 예측 결과 통계

- **총 예측 쌍**: 3,085개
- **평균 예측값**: 4,271,836
- **최대 예측값**: 105,018,506
- **최소 예측값**: 0

---

## ✅ 모델의 장점

### 1. 도메인 지식 활용
- HS4 코드를 활용한 공급망 구조 반영
- 실제 산업 공급망 방향성 고려

### 2. 더 많은 공행성쌍 발견
- 기존: 1,425개 → 공급망 모델: 3,085개
- 공급망 방향성이 좋은 쌍에 대해 임계값 완화

### 3. 예측 정확도 향상 가능성
- 공급망 정보를 feature로 추가
- 같은 HS4 그룹 내 공행성 강조

### 4. 해석 가능성
- 공급망 계층별 분포 분석 가능
- 공행성의 산업적 의미 파악 가능

---

## 🔄 다음 단계 개선 제안

### 1. HS4 계층 구조 더 세밀하게
- HS2, HS6 코드 활용
- 품목 간 실제 공급망 관계 데이터 활용

### 2. 계절성 고려
- 월별 계절 지표 추가
- 전년 동월 대비 변화율

### 3. 앙상블 모델
- 공급망 모델 + 기존 모델 앙상블
- 가중 평균 또는 스태킹

### 4. 딥러닝 모델
- LSTM/GRU로 시계열 패턴 학습
- Attention 메커니즘으로 공급망 관계 학습

---

## 📝 파일 구조

```
train_model_supply_chain.py  # 공급망 기반 모델 (메인)
supply_chain_submit.csv      # 예측 결과
baseline_submit.csv          # 기존 모델 결과 (비교용)
```

---

## 🎓 결론

기계산업 공급망을 고려한 모델은:
1. **더 많은 공행성쌍 발견** (116% 증가)
2. **도메인 지식 활용** (HS4 코드, 공급망 계층)
3. **해석 가능성 향상** (공급망 방향성 분석)
4. **예측 정확도 개선 가능성** (추가 feature)

이는 단순한 데이터 기반 접근법에서 **도메인 지식을 활용한 지능형 모델**로의 진화입니다.

